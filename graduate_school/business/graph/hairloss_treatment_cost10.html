<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>탈모 현황 종합 리포트</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f8fafc;
            overflow-x: hidden;
        }
        .card {
            background: white;
            border-radius: 24px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.03);
            border: 1px solid #f1f5f9;
            overflow: hidden; 
        }
        .title-box {
            background-color: #f1f5f9;
            padding: 16px 0; 
            border-radius: 14px;
            border: 1px solid #e2e8f0;
            margin-bottom: 1.25rem;
            text-align: center;
        }
        .chart-container-left {
            position: relative;
            height: 500px; /* 너비가 늘어남에 따라 높이 소폭 조정 */
            width: 100%;
        }
        .chart-container-right {
            position: relative;
            height: 240px; 
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        canvas {
            z-index: 1;
        }
        
        .burden-wrapper {
            position: relative;
            width: 220px; 
            height: 220px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .burden-circle-svg {
            position: absolute;
            width: 100%;
            height: 100%;
        }
        .burden-center {
            width: 185px; 
            height: 185px;
            background: white;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 5;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.02);
            padding: 10px;
        }
        
        .burden-center h3 {
            margin-bottom: 6px;
            font-size: 1.6rem; 
            font-weight: 900;
            line-height: 1.1;
            letter-spacing: -0.03em;
            color: #1e293b;
            word-break: keep-all;
        }
        
        .interaction-arrow {
            font-size: 42px; 
            color: #cbd5e1;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 220px;
        }
        
        .highlight-badge {
            position: absolute;
            top: 45px; 
            right: -15px; 
            background-color: #1e293b;
            color: white;
            padding: 12px 24px; 
            border-radius: 20px;
            font-size: 22px; 
            font-weight: 900;
            box-shadow: 0 6px 12px rgba(0,0,0,0.25);
            z-index: 10;
            text-align: center;
            line-height: 1.1;
        }
        .highlight-badge span {
            display: block;
            margin-top: 4px;
            font-size: 20px; 
            font-weight: 400;
            opacity: 0.9;
        }

        .burden-img-single {
            width: 140px; 
            height: 75px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background-color: transparent;
        }
        .burden-img-single img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            visibility: hidden; 
        }
    </style>
</head>
<body class="p-6 md:p-10">

    <!-- 너비 확장: max-w-[2400px] -->
    <div class="w-full mx-auto max-w-[2400px]">
        <div class="grid grid-cols-1 lg:grid-cols-5 gap-10 items-stretch">
            
            <!-- Left Column: 탈모 진료비 현황 -->
            <div class="lg:col-span-3 flex flex-col">
                <div class="title-box">
                    <h1 class="text-4xl font-black text-slate-800 tracking-tight">
                        탈모 진료비 현황 <span class="text-2xl font-light ml-2 text-slate-500">(2020-2023)</span>
                    </h1>
                </div>
                
                <div class="card p-12 flex-grow border border-slate-100 flex flex-col">
                    <div class="flex items-center justify-between mb-10">
                        <h2 class="text-3xl font-bold text-slate-700 ml-2">연도별 진료비 (단위: 백만 원)</h2>
                        <div class="flex gap-14 text-3xl">
                            <span class="flex items-center gap-4">
                                <span class="w-14 h-3 rounded-full bg-blue-500"></span> 
                                <span class="font-bold text-slate-600">남성</span>
                            </span>
                            <span class="flex items-center gap-4">
                                <span class="w-14 h-3 rounded-full bg-pink-500"></span> 
                                <span class="font-bold text-slate-600">여성</span>
                            </span>
                        </div>
                    </div>
                    
                    <div class="chart-container-left flex-grow">
                        <canvas id="hairLossExpenseChart"></canvas>
                    </div>

                    <p class="text-right text-xl text-slate-400 mt-10 mr-2 font-medium">
                        ※ 출처: 국민건강보험공단, 장종태의원실 재구성
                    </p>
                </div>
            </div>

            <!-- Right Column -->
            <div class="lg:col-span-2 flex flex-col gap-10">
                
                <!-- 연령별 환자 비율 -->
                <div class="flex flex-col">
                    <div class="title-box">
                        <h1 class="text-4xl font-black text-slate-800 tracking-tight">
                            연령별 비율 <span class="text-2xl font-light ml-2 text-slate-500">(2024년)</span>
                        </h1>
                    </div>
                    
                    <div class="card p-12 border border-slate-100">
                        <div class="grid grid-cols-2 gap-12">
                            <div class="text-center relative">
                                <span class="inline-block px-10 py-3 bg-blue-50 text-blue-600 rounded-full text-2xl font-black mb-8">남성</span>
                                <div class="highlight-badge">2030세대<span>(42.0%)</span></div>
                                <div class="chart-container-right">
                                    <canvas id="maleAgePieChart"></canvas>
                                </div>
                            </div>
                            <div class="text-center relative">
                                <span class="inline-block px-10 py-3 bg-pink-50 text-pink-600 rounded-full text-2xl font-black mb-8">여성</span>
                                <div class="highlight-badge">2030세대<span>(30.1%)</span></div>
                                <div class="chart-container-right">
                                    <canvas id="femaleAgePieChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <p class="text-xl text-slate-400 mt-8 text-right font-medium mr-2">
                            ※ 출처: 건강보험심사평가원(2024년 기준)
                        </p>
                    </div>
                </div>

                <!-- 탈모의 다차원적 부담 -->
                <div class="flex flex-col flex-grow">
                    <div class="title-box">
                        <h1 class="text-4xl font-black text-slate-800 tracking-tight">탈모의 다차원적 부담</h1>
                    </div>
                    
                    <div class="card p-12 bg-white flex-grow flex flex-col justify-center border border-slate-100">
                        <div class="flex items-center justify-around w-full mb-4">
                            
                            <div class="flex flex-col items-center">
                                <div class="burden-wrapper">
                                    <svg class="burden-circle-svg" viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="46" fill="none" stroke="#dcfce7" stroke-width="2" />
                                        <circle cx="50" cy="50" r="40" fill="none" stroke="#10b981" stroke-width="12" />
                                    </svg>
                                    <div class="burden-center">
                                        <h3>신체적 문제</h3>
                                        <div class="burden-img-single">
                                            <img src="img01-removebg-preview.png" alt="" onerror="this.style.visibility='hidden';" onload="this.style.visibility='visible';">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="interaction-arrow">⇄</div>

                            <div class="flex flex-col items-center">
                                <div class="burden-wrapper">
                                    <svg class="burden-circle-svg" viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="46" fill="none" stroke="#e0f2fe" stroke-width="2" />
                                        <circle cx="50" cy="50" r="40" fill="none" stroke="#0ea5e9" stroke-width="12" />
                                    </svg>
                                    <div class="burden-center">
                                        <h3>심리·정신적<br>문제</h3>
                                        <div class="burden-img-single">
                                            <img src="img02-removebg-preview.png" alt="" onerror="this.style.visibility='hidden';" onload="this.style.visibility='visible';">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="interaction-arrow">⇄</div>

                            <div class="flex flex-col items-center">
                                <div class="burden-wrapper">
                                    <svg class="burden-circle-svg" viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="46" fill="none" stroke="#ffe4e6" stroke-width="2" />
                                        <circle cx="50" cy="50" r="40" fill="none" stroke="#f43f5e" stroke-width="12" />
                                    </svg>
                                    <div class="burden-center">
                                        <h3>사회·경제적<br>활동 위축</h3>
                                        <div class="burden-img-single">
                                            <img src="img03-removebg-preview.png" alt="" onerror="this.style.visibility='hidden';" onload="this.style.visibility='visible';">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <p class="text-xl text-slate-400 mt-6 mr-2 font-medium text-right">
                            ※ 출처: 대한모발학회 및 관련 연구 종합
                        </p>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        Chart.register(ChartDataLabels);

        function createDiagonalPattern(color) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const size = 12; 
            canvas.width = size;
            canvas.height = size;
            ctx.fillStyle = color;
            ctx.fillRect(0, 0, size, size);
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.25)'; 
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(0, size);
            ctx.lineTo(size, 0);
            ctx.stroke();
            return ctx.createPattern(canvas, 'repeat');
        }

        const verticalLinePlugin = {
            id: 'verticalLinePlugin',
            beforeDatasetsDraw: (chart) => {
                if(chart.canvas.id !== 'hairLossExpenseChart') return;
                const { ctx, chartArea: { bottom } } = chart;
                ctx.save();
                ctx.strokeStyle = '#e2e8f0'; 
                ctx.lineWidth = 2; 
                ctx.setLineDash([6, 6]); 
                const maleMeta = chart.getDatasetMeta(0);
                maleMeta.data.forEach((point) => {
                    ctx.beginPath();
                    ctx.moveTo(point.x, point.y);
                    ctx.lineTo(point.x, bottom);
                    ctx.stroke();
                });
                ctx.restore();
            }
        };

        Chart.register(verticalLinePlugin);

        const expCtx = document.getElementById('hairLossExpenseChart').getContext('2d');
        const maleExpData = [21780514, 23229488, 24024286, 24782480];
        const femaleExpData = [17105406, 18869398, 19841337, 20067358];

        new Chart(expCtx, {
            type: 'line',
            data: {
                labels: ['2020년', '2021년', '2022년', '2023년'],
                datasets: [
                    {
                        label: '남성',
                        data: maleExpData,
                        borderColor: '#3b82f6',
                        borderWidth: 10, 
                        pointBackgroundColor: '#fff',
                        pointBorderColor: '#3b82f6',
                        pointBorderWidth: 6,
                        pointRadius: 12,
                        tension: 0,
                        datalabels: { color: '#3b82f6', font: { size: 28, weight: 'bold' } }
                    },
                    {
                        label: '여성',
                        data: femaleExpData,
                        borderColor: '#ec4899',
                        borderWidth: 10,
                        pointBackgroundColor: '#fff',
                        pointBorderColor: '#ec4899',
                        pointBorderWidth: 6,
                        pointRadius: 12,
                        tension: 0,
                        datalabels: { color: '#ec4899', font: { size: 28, weight: 'bold' } }
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                layout: { padding: { top: 60, bottom: 20, left: 10, right: 60 } },
                scales: {
                    y: {
                        min: 14000000,
                        grid: { display: false, drawBorder: false },
                        ticks: { display: false },
                        title: {
                            display: true,
                            text: '진료비 (백만 원)',
                            color: '#475569',
                            font: { size: 32, weight: '900' }, 
                            padding: { bottom: 40 }
                        }
                    },
                    x: {
                        offset: true,
                        grid: { display: false },
                        ticks: { color: '#64748b', font: { size: 28, weight: 'bold' } } 
                    }
                },
                plugins: {
                    legend: { display: false },
                    datalabels: {
                        align: 'top',
                        anchor: 'end',
                        offset: 22,
                        formatter: (value) => (value / 1000000).toFixed(1)
                    }
                }
            }
        });

        const ageLabels = ['20대', '30대', '40대', '50대', '기타'];
        const maleAgeData = [24578, 33934, 32813, 23585, 24365];
        const femaleAgeData = [14501, 17685, 21911, 23328, 29384];
        const maleColors = ['#1d4ed8', '#2563eb', '#3b82f6', '#60a5fa', '#e2e8f0'];
        const femaleColors = ['#be185d', '#db2777', '#ec4899', '#f472b6', '#e2e8f0'];

        const commonPieOptions = {
            responsive: true,
            maintainAspectRatio: false,
            cutout: '55%',
            plugins: {
                legend: { display: false },
                datalabels: {
                    display: true,
                    anchor: 'center',
                    align: 'center',
                    color: (context) => context.dataIndex === 4 ? '#475569' : '#fff',
                    font: { weight: 'bold', size: 24 }, 
                    formatter: (value, context) => context.chart.data.labels[context.dataIndex]
                }
            }
        };

        new Chart(document.getElementById('maleAgePieChart').getContext('2d'), {
            type: 'doughnut',
            data: {
                labels: ageLabels,
                datasets: [{
                    data: maleAgeData,
                    backgroundColor: maleColors.map((color, index) => index < 4 ? createDiagonalPattern(color) : color),
                    borderWidth: [12, 12, 2, 2, 2],
                    borderColor: ['#0f172a', '#0f172a', '#fff', '#fff', '#fff'],
                    borderAlign: 'inner'
                }]
            },
            options: commonPieOptions
        });

        new Chart(document.getElementById('femaleAgePieChart').getContext('2d'), {
            type: 'doughnut',
            data: {
                labels: ageLabels,
                datasets: [{
                    data: femaleAgeData,
                    backgroundColor: femaleColors.map((color, index) => index < 4 ? createDiagonalPattern(color) : color),
                    borderWidth: [12, 12, 2, 2, 2],
                    borderColor: ['#500724', '#500724', '#fff', '#fff', '#fff'],
                    borderAlign: 'inner'
                }]
            },
            options: commonPieOptions
        });
    </script>
</body>
</html>