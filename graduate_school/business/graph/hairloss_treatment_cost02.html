<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>탈모 현황 종합 리포트</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f8fafc;
        }
        .card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
        }
        /* 제목 스타일: 카드 너비와 동일하게 적용 */
        .title-box {
            background-color: #f1f5f9;
            padding: 12px 0;
            border-radius: 15px;
            border: 1px solid #e2e8f0;
            margin-bottom: 1rem;
            text-align: center;
        }
        .chart-container-left {
            position: relative;
            height: 520px; /* 정렬을 위한 높이 조정 */
            width: 100%;
        }
        .chart-container-right {
            position: relative;
            height: 200px; /* 좌우 배치이므로 높이 소폭 조정 */
            width: 100%;
        }
        .burden-icon {
            width: 42px;
            height: 42px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            margin-bottom: 6px;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <!-- 1번 요청: 너비 비중 조정 (lg:grid-cols-5 사용, 좌3:우2 = 60%:40%) -->
        <div class="grid grid-cols-1 lg:grid-cols-5 gap-8 items-stretch">
            
            <!-- Left Column: 탈모 진료비 현황 -->
            <div class="lg:col-span-3 flex flex-col">
                <div class="title-box">
                    <h1 class="text-xl font-bold text-slate-800">탈모 진료비 현황</h1>
                </div>
                
                <div class="card p-6 flex-grow">
                    <div class="flex items-center justify-between mb-8">
                        <h2 class="text-lg font-bold text-slate-700 ml-2">연도별 진료비 (단위: 백만 원)</h2>
                        <div class="flex gap-6 text-sm">
                            <span class="flex items-center gap-2">
                                <span class="w-8 h-1 rounded-full bg-blue-500"></span> 
                                <span class="font-medium text-slate-600">남성</span>
                            </span>
                            <span class="flex items-center gap-2">
                                <span class="w-8 h-1 rounded-full bg-pink-500"></span> 
                                <span class="font-medium text-slate-600">여성</span>
                            </span>
                        </div>
                    </div>
                    
                    <div class="chart-container-left">
                        <canvas id="hairLossExpenseChart"></canvas>
                    </div>

                    <p class="text-right text-sm text-slate-400 mt-6 mr-2 font-medium">
                        ※출처 : 국민건강보험공단, 장종태의원실 재구성
                    </p>
                </div>
            </div>

            <!-- Right Column -->
            <div class="lg:col-span-2 flex flex-col gap-6">
                
                <!-- 연령별 환자 비율 카드 -->
                <div class="flex flex-col">
                    <div class="title-box">
                        <h1 class="text-xl font-bold text-slate-800">탈모 환자 연령별 비율 (2024년 기준)</h1>
                    </div>
                    
                    <div class="card p-6">
                        <div class="grid grid-cols-2 gap-4">
                            <!-- 남성 파이 -->
                            <div class="text-center">
                                <span class="inline-block px-3 py-1 bg-blue-50 text-blue-600 rounded-full text-[10px] font-bold mb-2">남성</span>
                                <div class="chart-container-right">
                                    <canvas id="maleAgePieChart"></canvas>
                                </div>
                            </div>
                            <!-- 여성 파이 -->
                            <div class="text-center">
                                <span class="inline-block px-3 py-1 bg-pink-50 text-pink-600 rounded-full text-[10px] font-bold mb-2">여성</span>
                                <div class="chart-container-right">
                                    <canvas id="femaleAgePieChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <p class="text-[11px] text-slate-400 mt-4 text-right font-medium">
                            ※ 출처: 건강보험심사평가원(2024년 기준)
                        </p>
                    </div>
                </div>

                <!-- 3번 요청: 탈모의 다차원적 부담 제목 양식 통일 및 위치 조정 -->
                <div class="flex flex-col flex-grow">
                    <div class="title-box">
                        <h1 class="text-xl font-bold text-slate-800">탈모의 다차원적 부담</h1>
                    </div>
                    
                    <!-- 4번 요청: 하단 정렬을 위한 flex-grow 및 padding 조정 -->
                    <div class="card p-6 bg-slate-50 border border-slate-100 flex-grow flex flex-col justify-center">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="flex flex-col items-center text-center p-3 bg-white rounded-xl shadow-sm border border-slate-50">
                                <div class="burden-icon bg-blue-50 text-blue-500">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                </div>
                                <span class="text-xs font-bold text-slate-700">심리적 고통</span>
                                <span class="text-[10px] text-slate-500 mt-1 leading-tight">자존감 하락 및 우울감</span>
                            </div>
                            <div class="flex flex-col items-center text-center p-3 bg-white rounded-xl shadow-sm border border-slate-50">
                                <div class="burden-icon bg-pink-50 text-pink-500">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" /></svg>
                                </div>
                                <span class="text-xs font-bold text-slate-700">사회적 제약</span>
                                <span class="text-[10px] text-slate-500 mt-1 leading-tight">대인기피 및 관계 위축</span>
                            </div>
                            <div class="flex flex-col items-center text-center p-3 bg-white rounded-xl shadow-sm border border-slate-50">
                                <div class="burden-icon bg-amber-50 text-amber-500">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                </div>
                                <span class="text-xs font-bold text-slate-700">경제적 부담</span>
                                <span class="text-[10px] text-slate-500 mt-1 leading-tight">지속적인 치료비 지출</span>
                            </div>
                            <div class="flex flex-col items-center text-center p-3 bg-white rounded-xl shadow-sm border border-slate-50">
                                <div class="burden-icon bg-emerald-50 text-emerald-500">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>
                                </div>
                                <span class="text-xs font-bold text-slate-700">신체적 영향</span>
                                <span class="text-[10px] text-slate-500 mt-1 leading-tight">두피 보호 능력 저하</span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        Chart.register(ChartDataLabels);

        // 1. 탈모 진료비 현황 (Line Chart)
        const verticalLinePlugin = {
            id: 'verticalLinePlugin',
            beforeDatasetsDraw: (chart) => {
                if(chart.canvas.id !== 'hairLossExpenseChart') return;
                const { ctx, chartArea: { bottom } } = chart;
                ctx.save();
                ctx.strokeStyle = '#e2e8f0'; 
                ctx.lineWidth = 1;
                ctx.setLineDash([4, 4]); 

                const maleMeta = chart.getDatasetMeta(0);
                maleMeta.data.forEach((point) => {
                    ctx.beginPath();
                    ctx.moveTo(point.x, point.y);
                    ctx.lineTo(point.x, bottom);
                    ctx.stroke();
                });
                ctx.restore();
            }
        };

        Chart.register(verticalLinePlugin);

        const expCtx = document.getElementById('hairLossExpenseChart').getContext('2d');
        const expYears = ['2020년', '2021년', '2022년', '2023년'];
        const maleExpData = [21780514, 23229488, 24024286, 24782480];
        const femaleExpData = [17105406, 18869398, 19841337, 20067358];

        new Chart(expCtx, {
            type: 'line',
            data: {
                labels: expYears,
                datasets: [
                    {
                        label: '남성',
                        data: maleExpData,
                        borderColor: '#3b82f6',
                        borderWidth: 4,
                        pointBackgroundColor: '#fff',
                        pointBorderColor: '#3b82f6',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        tension: 0,
                        datalabels: { color: '#3b82f6' }
                    },
                    {
                        label: '여성',
                        data: femaleExpData,
                        borderColor: '#ec4899',
                        borderWidth: 4,
                        pointBackgroundColor: '#fff',
                        pointBorderColor: '#ec4899',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        tension: 0,
                        datalabels: { color: '#ec4899' }
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                layout: { padding: { top: 35, bottom: 10, left: 10, right: 20 } },
                scales: {
                    y: {
                        min: 14000000,
                        grid: { display: false, drawBorder: false },
                        ticks: { display: false },
                        title: {
                            display: true,
                            text: '진료비 (단위: 백만 원)',
                            color: '#475569',
                            font: { size: 18, weight: 'bold' },
                            padding: { bottom: 15 }
                        }
                    },
                    x: {
                        offset: true,
                        grid: { display: false },
                        ticks: { color: '#64748b', font: { size: 16, weight: 'bold' } }
                    }
                },
                plugins: {
                    legend: { display: false },
                    datalabels: {
                        align: 'top',
                        anchor: 'end',
                        offset: 8,
                        font: { weight: 'bold', size: 14 },
                        formatter: (value) => (value / 1000000).toFixed(1)
                    }
                }
            }
        });

        // 2. 연령별 환자 비율 (남/여 파이 그래프)
        const ageLabels = ['20대', '30대', '40대', '50대', '기타'];
        const maleAgeData = [24578, 33934, 32813, 23585, 24365];
        const femaleAgeData = [14501, 17685, 21911, 23328, 29384];

        const commonPieOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false 
                },
                datalabels: {
                    display: true,
                    // '기타' 항목은 배경색이 연하므로 글자색 조정
                    color: (context) => context.dataIndex === 4 ? '#475569' : '#fff',
                    font: { weight: 'bold', size: 10 },
                    formatter: (value, context) => {
                        return context.chart.data.labels[context.dataIndex];
                    }
                }
            }
        };

        // 2번 요청: 20대부터 50대로 갈수록 색이 연해지도록 설정
        // 남성 그래프 (진한 파랑 -> 연한 파랑)
        new Chart(document.getElementById('maleAgePieChart').getContext('2d'), {
            type: 'pie',
            data: {
                labels: ageLabels,
                datasets: [{
                    data: maleAgeData,
                    backgroundColor: ['#1d4ed8', '#2563eb', '#3b82f6', '#60a5fa', '#e2e8f0'],
                    borderWidth: 1
                }]
            },
            options: commonPieOptions
        });

        // 여성 그래프 (진한 핑크 -> 연한 핑크)
        new Chart(document.getElementById('femaleAgePieChart').getContext('2d'), {
            type: 'pie',
            data: {
                labels: ageLabels,
                datasets: [{
                    data: femaleAgeData,
                    backgroundColor: ['#be185d', '#db2777', '#ec4899', '#f472b6', '#e2e8f0'],
                    borderWidth: 1
                }]
            },
            options: commonPieOptions
        });
    </script>
</body>
</html>